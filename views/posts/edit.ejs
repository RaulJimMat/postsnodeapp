<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
</head>
<body>
	<h1>Edit Post!</h1>
	<form action="/posts/<%= post.id %>?_method=PUT" method="POST" id="postEditForm">
		<div><input type="text" name="post[title]" placeholder="Title" value="<%= post.title %>"></div>
		<div><input type="text" name="post[price]" placeholder="Price" value="<%= post.price %>"></div>
	<div>
		<input type="file" id="imageUpload" accept="images/*" name ="images" multiple />
		<div>
			<% post.images.forEach(function(image, i) { %>
				<img src="<%= image.url %>" width="100px">
				<label for="image<%= i %>">Delete?</label>
				<input type="checkbox" name="deleteImage" class="imageDeleteCheckbox" id="image<%= i %>" value="<%= image.public_id %>"/>
			<% }); %>
	</div>
	</div>

		<div>
			<textarea id="" name="post[description]" placeholder="Description" cols="30" rows="10"><%= post.description %></textarea>
		</div>
		<div><input type="text" name="post[location]" placeholder="Location" value="<%= post.location %>"></div>

		<div><input type="submit" ></div>
	</form>	
	
</body>
</html>

 <script>
	let postEditForm = document.getElementById('postEditForm'); 
	postEditForm.addEventListener('submit',function(event) {
		let imageUpload = document.getElementById('imageUpload').files.length;
 		let existingImages = document.querySelectorAll('.imageDeleteCheckbox').length;
 		let imagesDeletions = document.querySelectorAll('.imageDeleteCheckbox:checked').length;
		let newImagesTotal = existingImages - imagesDeletions + imageUpload;
		if( newImagesTotal > 4){
			event.preventDefault();
			let removalAmt = newImagesTotal - 4;
			alert(`You nedd to delete at least ${removalAmt} image${removalAmt === 1 ? '' : 's'}!`);
		}
	});
 </script>
